func buildPhaseAwareStatusWhere(
    statusPhase string,
    approvalStatuses, workStatuses []string,
) (string, []any) {
    buildIn := func(col string, vals []string) (string, []any) { /* same as before */ }

    clauses := []string{}
    args := []any{}

    // If a specific statusPhase is provided (mdl/rig/bld/dsn/ldv),
    // limit filters to that phase
    if statusPhase != "" && strings.ToLower(statusPhase) != "none" {
        clauses = append(clauses, "LOWER(phase) = ?")
        args = append(args, strings.ToLower(statusPhase))
    }

    if c, a := buildIn("approval_status", approvalStatuses); c != "" {
        clauses = append(clauses, "("+c+")")
        args = append(args, a...)
    }
    if c, a := buildIn("work_status", workStatuses); c != "" {
        clauses = append(clauses, "("+c+")")
        args = append(args, a...)
    }

    if len(clauses) == 0 {
        return "", nil
    }
    return " AND " + strings.Join(clauses, " AND "), args
}
