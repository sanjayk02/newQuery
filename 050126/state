<Menu
  anchorEl={filterAnchorEl}
  open={Boolean(filterAnchorEl)}
  onClose={() => setFilterAnchorEl(null)}
  keepMounted
  PaperProps={{
    style: {
      width: 320,
      maxHeight: 520,
      background: "#2f2f2f",
      color: "#e0e0e0",
      borderRadius: 6,
    },
  }}
>
  {/* Clear all */}
  <MenuItem
    dense
    onClick={() => setSelectedTopGroups([])}
    style={{ fontWeight: 600 }}
  >
    Clear all filters
  </MenuItem>

  <Divider />

  {/* Collapsible Section Header: Asset Type */}
  <List disablePadding>
    <ListItem
      button
      dense
      onClick={() => setAssetTypeOpen((v) => !v)}
      style={{ paddingLeft: 12, paddingRight: 12 }}
    >
      <ListItemText
        primary="Asset Type"
        primaryTypographyProps={{ style: { fontSize: 12, fontWeight: 700 } }}
      />
      {assetTypeOpen ? <ExpandLess /> : <ExpandMore />}
    </ListItem>

    <Collapse in={assetTypeOpen} timeout="auto" unmountOnExit>
      <Box style={{ maxHeight: 360, overflowY: "auto" }}>
        {(topGroupNames || []).map((name) => {
          const isChecked = selectedTopGroups.includes(name);
          const count = topGroupCounts.get(name) ?? 0; // keep your counts logic

          return (
            <MenuItem
              key={name}
              dense
              onClick={() => {
                setSelectedTopGroups((prev) =>
                  prev.includes(name)
                    ? prev.filter((n) => n !== name)
                    : [...prev, name]
                );
              }}
            >
              <Checkbox checked={isChecked} size="small" />
              <ListItemText
                primary={name}
                primaryTypographyProps={{ style: { fontSize: 13 } }}
              />
              <Box style={{ marginLeft: 12, opacity: 0.75, fontSize: 12 }}>
                {count}
              </Box>
            </MenuItem>
          );
        })}
      </Box>
    </Collapse>
  </List>
</Menu>
