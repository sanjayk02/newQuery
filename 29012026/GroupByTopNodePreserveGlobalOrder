func GroupAndSortByTopNode(rows []AssetPivot) []GroupedAssetBucket {
	grouped := make(map[string][]AssetPivot)
	order := []string{}

	for _, row := range rows {
		key := strings.TrimSpace(row.TopGroupNode)
		if key == "" {
			key = "Unassigned"
		}
		if _, ok := grouped[key]; !ok {
			grouped[key] = []AssetPivot{}
			order = append(order, key)
		}
		grouped[key] = append(grouped[key], row)
	}

	// Group headers Aâ†’Z, Unassigned last
	sort.Slice(order, func(i, j int) bool {
		if order[i] == "Unassigned" {
			return false
		}
		if order[j] == "Unassigned" {
			return true
		}
		return strings.ToLower(order[i]) < strings.ToLower(order[j])
	})

	out := make([]GroupedAssetBucket, 0, len(order))
	for _, key := range order {
		out = append(out, GroupedAssetBucket{
			TopGroupNode: key,
			Items:        grouped[key], // order preserved
		})
	}

	return out
}
