WITH ranked AS (
  SELECT
    ri.project,
    ri.root,
    ri.group_1,
    ri.relation,
    JSON_UNQUOTE(JSON_EXTRACT(ri.groups, '$[0]')) AS leaf_group_name,
    ri.modified_at_utc,
    ROW_NUMBER() OVER (
      PARTITION BY ri.project, ri.root, ri.group_1, ri.relation
      ORDER BY ri.modified_at_utc DESC
    ) AS rn
  FROM t_review_info ri
  WHERE ri.project = ?
    AND ri.root = 'assets'
    AND ri.deleted = 0
)
SELECT
  project,
  root,
  group_1,
  relation,
  leaf_group_name,
  COUNT(*) OVER () AS total_count
FROM ranked
WHERE rn = 1
LIMIT ? OFFSET ?;
